<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover"
    />
    <title>Theme</title>
    <link rel="stylesheet" href="src/ui/common/styles/global.css" />
    <script type="module" src="src/ui/common/icon.ts"></script>
    <style>
      body {
        overflow: auto;
        background: var(--color-bg-content);
        padding: var(--space-8);
        gap: var(--space-8);
      }

      .swatch {
        margin: var(--space-2);
        font-size: var(--text-xs);
        display: inline-block;
        padding: var(--space-5);
        width: 64px;
        height: 64px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        transition: all 0.2s ease;
        border-radius: 50%;
        /* border: 1px solid var(--color-neutral-1000); */
      }

      .swatch:not(:first-child) {
        margin-left: -48px;
      }

      .swatch:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .theme-block {
        margin-bottom: var(--space-8);
      }

      .swatches {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
      }

      .color-group {
        margin-bottom: var(--space-6);
      }

      .color-group h3 {
        margin-bottom: var(--space-2);
        border-bottom: 1px solid var(--color-border-default);
        padding-bottom: var(--space-2);
      }

      .icon-grid {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
      }

      .icon-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1rem;
        border: 1px solid var(--color-border);
        border-radius: 8px;
      }

      .icon-name {
        margin-top: 0.5rem;
        font-size: 12px;
      }
    </style>
  </head>
  <body class="theme-block">
    <h1>Theme</h1>
    <div class="theme-block">
      <h2>Color Palette</h2>
      <div id="color-swatches"></div>
    </div>
    <div class="theme-block">
      <h2>Typography</h2>
      <div>
        <h3>Sizes</h3>
        <div style="font-size: var(--text-3xl)">This is 3xl text</div>
        <div style="font-size: var(--text-xxl)">This is xxl text</div>
        <div style="font-size: var(--text-xl)">This is xl text</div>
        <div style="font-size: var(--text-lg)">This is lg text</div>
        <div style="font-size: var(--text-base)">This is base text</div>
        <div style="font-size: var(--text-sm)">This is sm text</div>
        <div style="font-size: var(--text-xs)">This is xs text</div>
      </div>
      <div>
        <h3>Styles</h3>
        <div style="color: var(--color-text-muted)">
          Here is some muted text
        </div>
      </div>
      <div class="prose">
        <h1>This is the main heading of a prose block</h1>
        <p>
          This is a lead paragraph that might introduce your content. It could
          be styled differently than regular paragraphs to create visual
          hierarchy.
        </p>
        <p>
          A second paragraph will typically follow, because that's just a thing
          you do when you write. It could have many sentences. It could have
          just one. That's the thing about writing. You have a lot of options.
        </p>

        <h2>Secondary Heading</h2>
        <p>
          Regular paragraph text with <em>emphasized</em> and
          <strong>bold</strong> text. You might also need styles for
          <a href="#">links</a> and <code>inline code</code>.
        </p>

        <h3>Tertiary Heading</h3>
        <ul>
          <li>Unordered list item one</li>
          <li>List item with <a href="#">a link</a></li>
          <li>
            A longer list item that wraps to multiple lines to test line height
            and spacing
          </li>
        </ul>

        <h4>Fourth Level Heading</h4>
        <ol>
          <li>Ordered list item one</li>
          <li>Second ordered list item</li>
          <li>Third ordered list item</li>
        </ol>

        <blockquote>
          <p>
            This is a blockquote. It might contain a notable quote or callout
            text that deserves special styling.
          </p>
        </blockquote>

        <pre><code>// This is a code block
function example() {
return "Hello, World!";
}</code></pre>

        <h5>Fifth Level Heading</h5>
        <p>
          Additional paragraph with <mark>highlighted text</mark> and
          <small>small text</small> variations. You might also want to style
          <sub>subscript</sub> and <sup>superscript</sup> text.
        </p>

        <hr />

        <h6>Sixth Level Heading</h6>
        <p>
          Final paragraph with a different type of
          <kbd>keyboard input</kbd> styling and maybe even
          <abbr title="Abbreviation">abbr</abbr> elements.
        </p>
      </div>
    </div>
    <div class="theme-block">
      <h2>Elements</h2>
      <div>
        <h3>Buttons</h3>
        <button>Test</button>
        <button disabled>Test</button>
        <a href="#">Link</a>
      </div>
      <div>
        <h3>Inputs</h3>
        <div>
          <label for="example-text-input">Text input</label>
          <input id="example-text-input" type="text" />
        </div>
        <div>
          <label for="example-text-input">Text input with error</label>
          <input id="example-text-input" class="error" type="text" />
          <div class="error-text">
            <p>Here is some error text</p>
          </div>
        </div>
        <div>
          <label for="example-checkbox">Checkbox</label>
          <input id="example-checkbox" type="checkbox" />
        </div>
        <div>
          <label for="example-radio">Radio</label>
          <input id="example-radio" type="radio" />
        </div>
        <div>
          <label for="example-select">Select</label>
          <select id="example-select">
            <option>default</option>
          </select>
        </div>
      </div>
    </div>
    <div class="theme-block">
      <h2>Common Icons</h2>
      <div class="icon-grid" id="icon-grid">
        <!-- Icons will be dynamically generated here -->
      </div>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Get all CSS variables from the document
        const colorGroups = {
          'Brand Colors': {
            Neutral: /^--color-neutral-/,
            Action: /^--color-action-/,
            Reaction: /^--color-reaction-/,
          },
          'Utility Colors': {
            Success: /^--color-success-/,
            Error: /^--color-error-/,
            Highlight: /^--color-highlight-/,
          },
          'UI Color Aliases': {
            Text: /^--color-text-/,
            Background: /^--color-bg-/,
            Border: /^--color-border-/,
          },
        };

        const colorSwatchesContainer =
          document.getElementById('color-swatches');

        // Get all computed styles
        const styles = getComputedStyle(document.documentElement);
        const cssVars = Array.from(document.styleSheets)
          .filter((sheet) => {
            try {
              // Filter out cross-origin stylesheets
              return (
                sheet.href === null ||
                sheet.href.startsWith(window.location.origin)
              );
            } catch (e) {
              return false;
            }
          })
          .reduce((acc, sheet) => {
            try {
              // Get all CSS rules that contain variable declarations
              const rules = Array.from(sheet.cssRules || []);
              rules.forEach((rule) => {
                if (rule.style) {
                  for (let i = 0; i < rule.style.length; i++) {
                    const prop = rule.style[i];
                    if (prop.startsWith('--color-')) {
                      acc.push(prop);
                    }
                  }
                }
              });
            } catch (e) {
              console.error('Error accessing CSS rules:', e);
            }
            return acc;
          }, []);

        // Remove duplicates
        const uniqueVars = [...new Set(cssVars)];

        // Create swatches for each group
        for (const [groupName, colorTypes] of Object.entries(colorGroups)) {
          const groupDiv = document.createElement('div');
          groupDiv.className = 'color-group';
          groupDiv.innerHTML = `<h3>${groupName}</h3>`;

          let hasColors = false;

          for (const [typeName, regex] of Object.entries(colorTypes)) {
            const typeDiv = document.createElement('div');
            typeDiv.innerHTML = `<h4>${typeName}</h4>`;

            const swatchesDiv = document.createElement('div');
            swatchesDiv.className = 'swatches';

            const matchingVars = uniqueVars.filter((v) => regex.test(v));

            // Sort variables numerically if they end with numbers
            matchingVars.sort((a, b) => {
              const aMatch = a.match(/(\d+)$/);
              const bMatch = b.match(/(\d+)$/);

              if (aMatch && bMatch) {
                return parseInt(aMatch[1]) - parseInt(bMatch[1]);
              }
              return a.localeCompare(b);
            });

            if (matchingVars.length > 0) {
              hasColors = true;

              matchingVars.forEach((varName) => {
                const value = styles.getPropertyValue(varName).trim();

                // Skip if the value is empty or references another var
                if (!value || value.includes('var(--')) {
                  return;
                }

                const swatch = document.createElement('div');
                swatch.className = 'swatch';
                swatch.style.backgroundColor = `var(${varName})`;
                swatchesDiv.appendChild(swatch);
              });

              typeDiv.appendChild(swatchesDiv);
              groupDiv.appendChild(typeDiv);
            }
          }

          if (hasColors) {
            colorSwatchesContainer.appendChild(groupDiv);
          }
        }
      });
    </script>
    <script type="module">
      import { ICON_MAP } from './src/ui/common/icon.ts';

      // Function to generate icon grid
      function generateIconGrid() {
        const iconGrid = document.getElementById('icon-grid');

        // Build HTML for all icons from ICON_MAP
        let iconsHtml = Object.entries(ICON_MAP)
          .map(
            ([key, value]) => `
          <div class="icon-item" title="${key}${key !== value ? ` (${value})` : ''}">
            <un-icon name="${key}"></un-icon>
          </div>
        `
          )
          .join('');

        // Set the HTML content
        iconGrid.innerHTML = iconsHtml;
      }

      // Generate the icon grid when the DOM is loaded
      document.addEventListener('DOMContentLoaded', generateIconGrid);
      if (
        document.readyState === 'complete' ||
        document.readyState === 'interactive'
      ) {
        setTimeout(generateIconGrid, 1);
      }
    </script>
  </body>
</html>
